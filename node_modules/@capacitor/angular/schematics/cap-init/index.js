"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const child_process_1 = require("child_process");
const rxjs_1 = require("rxjs");
function default_1({ command, args, }) {
    return (host, _context) => {
        return new rxjs_1.Observable((subscriber) => {
            if (command === 'npx') {
                command = process.platform === 'win32' ? 'npx.cmd' : 'npx';
            }
            else if (command === 'npm') {
                command = process.platform === 'win32' ? 'npm.cmd' : 'npm';
            }
            const cp = (0, child_process_1.spawn)(command, args, { stdio: 'inherit' });
            cp.on('error', (error) => {
                subscriber.error(error);
            });
            cp.on('close', () => {
                subscriber.next(host);
                subscriber.complete();
            });
            return () => {
                cp.kill();
                return host;
            };
        });
    };
}
exports.default = default_1;
